/************************
jquery-timepicker
http://jonthornton.github.com/jquery-timepicker/

requires jQuery 1.7+
************************/function TkMap(e){var t=typeof e.lat!="undefined"?e.lat:null,n=typeof e.lng!="undefined"?e.lng:null,r=typeof e.domid!="undefined"?e.domid:null,s=typeof e.zoom!="undefined"?e.zoom:15,o=typeof e.init!="undefined"?e.init:!1,u=typeof e.responsive!="undefined"?e.responsive:!1,a=typeof e.styles!="undefined"?e.styles:null,f={center:new google.maps.LatLng(t,n),draggable:!0,mapTypeControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,panControl:!1,streetViewControl:!1,styles:[],zoom:s,zoomControl:!0},l=!1,c=null,h=null;this.Map=null;var p=function(e){l=!0;c=e.touches[0].pageY},d=function(){l=!1},v=function(e){if(!l)return;h=e.touches[0].pageY;window.scrollBy(0,c-h)},m=function(){var e=a.split(" ");for(i in e)if(e[i]==="satellite")f.mapTypeId=google.maps.MapTypeId.SATELLITE;else if(e[i]==="hybrid")f.mapTypeId=google.maps.MapTypeId.HYBRID;else if(e[i]==="road")f.mapTypeId=google.maps.MapTypeId.ROADMAP;else if(e[i]==="terrain")f.mapTypeId=google.maps.MapTypeId.TERRAIN;else if(e[i]==="minlabels")f.styles.push({featureType:"all",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"on"}]});else if(e[i]==="grey"){f.backgroundColor="#C5C5C5";f.styles.push({stylers:[{saturation:-87}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{lightness:85}]},{featureType:"water",stylers:[{lightness:-20}]})}},g=function(){var e=$("#"+r).width();e<481?f.zoom--:e>959&&f.zoom++};this.initMap=function(){if(this.Map===null){a!==null&&m();u&&g();this.Map=new google.maps.Map(document.getElementById(r),f)}};this.setMapOptions=function(e){this.Map!==null&&$.extend(f,e)};this.setTouchScroll=function(e){var t=document.getElementById(r);if(e){t.addEventListener("touchstart",p,!0);t.addEventListener("touchend",d,!0);t.addEventListener("touchmove",v,!0);this.Map.setOptions({zoomControl:!1})}else{t.removeEventListener("touchstart",p,!0);t.removeEventListener("touchend",d,!0);t.removeEventListener("touchmove",v,!0);this.Map.setOptions({zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_TOP}})}};this.setPanZoom=function(e){var t;e?t=!1:t=!0;this.Map.setOptions({disableDoubleClickZoom:t,draggable:e,keyboardShortcuts:e,scrollwheel:e,zoomControl:e})};o===!0&&this.initMap()}function InfoBox(e){e=e||{};google.maps.OverlayView.apply(this,arguments);this.content_=e.content||"";this.disableAutoPan_=e.disableAutoPan||!1;this.maxWidth_=e.maxWidth||0;this.pixelOffset_=e.pixelOffset||new google.maps.Size(0,0);this.position_=e.position||new google.maps.LatLng(0,0);this.zIndex_=e.zIndex||null;this.boxClass_=e.boxClass||"infoBox";this.boxStyle_=e.boxStyle||{};this.closeBoxMargin_=e.closeBoxMargin||"2px";this.closeBoxURL_=e.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif";e.closeBoxURL===""&&(this.closeBoxURL_="");this.infoBoxClearance_=e.infoBoxClearance||new google.maps.Size(1,1);this.isHidden_=e.isHidden||!1;this.alignBottom_=e.alignBottom||!1;this.pane_=e.pane||"floatPane";this.enableEventPropagation_=e.enableEventPropagation||!1;this.div_=null;this.closeListener_=null;this.eventListener1_=null;this.eventListener2_=null;this.eventListener3_=null;this.moveListener_=null;this.contextListener_=null;this.fixedWidthSet_=null}(function(e){typeof define=="function"&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){function o(t){var r=t.data("timepicker-settings"),i=t.data("timepicker-list");if(i&&i.length){i.remove();t.data("timepicker-list",!1)}i=e("<ul />",{tabindex:-1,"class":"ui-timepicker-list"});r.className&&i.addClass(r.className);i.css({display:"none",position:"absolute"});(r.minTime!==null||r.durationTime!==null)&&r.showDuration&&i.addClass("ui-timepicker-with-duration");var s=r.durationTime!==null?r.durationTime:r.minTime,o=r.minTime!==null?r.minTime:0,u=r.maxTime!==null?r.maxTime:o+n-1;u<=o&&(u+=n);for(var a=o;a<=u;a+=r.step*60){var f=a%n,l=e("<li />");l.data("time",f);l.text(m(f,r.timeFormat));if((r.minTime!==null||r.durationTime!==null)&&r.showDuration){var h=e("<span />");h.addClass("ui-timepicker-duration");h.text(" ("+v(a-s)+")");l.append(h)}i.append(l)}i.data("timepicker-input",t);t.data("timepicker-list",i);var p=r.appendTo;typeof p=="string"?p=e(p):typeof p=="function"&&(p=p(t));p.append(i);c(t,i);i.on("click","li",function(n){t.addClass("ui-timepicker-hideme");t[0].focus();i.find("li").removeClass("ui-timepicker-selected");e(this).addClass("ui-timepicker-selected");d(t);i.hide()})}function u(){var e=new Date,t=e.getTimezoneOffset()*6e4;e.setHours(0);e.setMinutes(0);e.setSeconds(0);var n=e.getTimezoneOffset()*6e4;return new Date(e.valueOf()-n+t)}function a(){if("ontouchstart"in document)e("body").on("touchstart.ui-timepicker",f);else{e("body").on("mousedown.ui-timepicker",f);e(window).on("scroll.ui-timepicker",f)}}function f(t){var n=e(t.target),r=n.closest(".ui-timepicker-input");r.length===0&&n.closest(".ui-timepicker-list").length===0&&s.hide();e("body").unbind(".ui-timepicker");e(window).unbind(".ui-timepicker")}function l(t,n,r){if(!r&&r!==0)return!1;var i=t.data("timepicker-settings"),s=!1,o=i.step*30;n.find("li").each(function(t,n){var i=e(n),u=i.data("time")-r;if(Math.abs(u)<o||u==o){s=i;return!1}});return s}function c(e,t){var n=g(e.val()),r=l(e,t,n);r&&r.addClass("ui-timepicker-selected")}function h(){if(this.value==="")return;var t=e(this),n=g(this.value);if(n===null){t.trigger("timeFormatError");return}var r=t.data("timepicker-settings");if(r.forceRoundTime){var i=n%(r.step*60);i>=r.step*30?n+=r.step*60-i:n-=i}var s=m(n,r.timeFormat);t.val(s)}function p(t){var n=e(this),r=n.data("timepicker-list");if(!r.is(":visible")){if(t.keyCode!=40)return!0;n.focus()}switch(t.keyCode){case 13:d(n);s.hide.apply(this);t.preventDefault();return!1;case 38:var i=r.find(".ui-timepicker-selected");if(!i.length){r.children().each(function(t,n){if(e(n).position().top>0){i=e(n);return!1}});i.addClass("ui-timepicker-selected")}else if(!i.is(":first-child")){i.removeClass("ui-timepicker-selected");i.prev().addClass("ui-timepicker-selected");i.prev().position().top<i.outerHeight()&&r.scrollTop(r.scrollTop()-i.outerHeight())}break;case 40:i=r.find(".ui-timepicker-selected");if(i.length===0){r.children().each(function(t,n){if(e(n).position().top>0){i=e(n);return!1}});i.addClass("ui-timepicker-selected")}else if(!i.is(":last-child")){i.removeClass("ui-timepicker-selected");i.next().addClass("ui-timepicker-selected");i.next().position().top+2*i.outerHeight()>r.outerHeight()&&r.scrollTop(r.scrollTop()+i.outerHeight())}break;case 27:r.find("li").removeClass("ui-timepicker-selected");r.hide();break;case 9:s.hide();break;case 16:case 17:case 18:case 19:case 20:case 33:case 34:case 35:case 36:case 37:case 39:case 45:return;default:r.find("li").removeClass("ui-timepicker-selected");return}}function d(e){var t=e.data("timepicker-settings"),n=e.data("timepicker-list"),r=null,i=n.find(".ui-timepicker-selected");if(i.length)r=i.data("time");else if(e.val()){r=g(e.val());c(e,n)}if(r!==null){var s=m(r,t.timeFormat);e.val(s)}e.trigger("change").trigger("changeTime")}function v(e){var t=Math.round(e/60),n;if(Math.abs(t)<60)n=[t,i.mins];else if(t==60)n=["1",i.hr];else{var r=(t/60).toFixed(1);i.decimal!="."&&(r=r.replace(".",i.decimal));n=[r,i.hrs]}return n.join(" ")}function m(e,n){if(e===null)return;var r=new Date(t.valueOf()+e*1e3),i="",s,o;for(var u=0;u<n.length;u++){o=n.charAt(u);switch(o){case"a":i+=r.getHours()>11?"pm":"am";break;case"A":i+=r.getHours()>11?"PM":"AM";break;case"g":s=r.getHours()%12;i+=s===0?"12":s;break;case"G":i+=r.getHours();break;case"h":s=r.getHours()%12;s!==0&&s<10&&(s="0"+s);i+=s===0?"12":s;break;case"H":s=r.getHours();i+=s>9?s:"0"+s;break;case"i":var a=r.getMinutes();i+=a>9?a:"0"+a;break;case"s":e=r.getSeconds();i+=e>9?e:"0"+e;break;default:i+=o}}return i}function g(e){if(e==="")return null;if(e+0==e)return e;typeof e=="object"&&(e=e.getHours()+":"+e.getMinutes()+":"+e.getSeconds());var t=new Date(0),n=e.toLowerCase().match(/(\d{1,2})(?::(\d{1,2}))?(?::(\d{2}))?\s*([pa]?)/);if(!n)return null;var r=parseInt(n[1]*1,10),i;n[4]?r==12?i=n[4]=="p"?12:0:i=r+(n[4]=="p"?12:0):i=r;var s=n[2]*1||0,o=n[3]*1||0;return i*3600+s*60+o}var t=u(),n=86400,r={className:null,minTime:null,maxTime:null,durationTime:null,step:30,showDuration:!1,timeFormat:"g:ia",scrollDefaultNow:!1,scrollDefaultTime:!1,selectOnBlur:!1,forceRoundTime:!1,appendTo:"body"},i={decimal:".",mins:"mins",hr:"hr",hrs:"hrs"},s={init:function(t){return this.each(function(){var n=e(this);if(n[0].tagName=="SELECT"){var o={type:"text",value:n.val()},u=n[0].attributes;for(var a=0;a<u.length;a++)o[u[a].nodeName]=u[a].nodeValue;var f=e("<input />",o);n.replaceWith(f);n=f}var l=e.extend({},r);t&&(l=e.extend(l,t));l.minTime&&(l.minTime=g(l.minTime));l.maxTime&&(l.maxTime=g(l.maxTime));l.durationTime&&(l.durationTime=g(l.durationTime));l.lang&&(i=e.extend(i,l.lang));n.data("timepicker-settings",l);n.prop("autocomplete","off");n.on("click.timepicker focus.timepicker",s.show);n.on("blur.timepicker",h);n.on("keydown.timepicker",p);n.addClass("ui-timepicker-input");h.call(n.get(0))})},show:function(t){var n=e(this);"ontouchstart"in document&&n.blur();var r=n.data("timepicker-list");if(n.prop("readonly"))return;if(!r||r.length===0){o(n);r=n.data("timepicker-list")}if(n.hasClass("ui-timepicker-hideme")){n.removeClass("ui-timepicker-hideme");r.hide();return}if(r.is(":visible"))return;s.hide();n.offset().top+n.outerHeight(!0)+r.outerHeight()>e(window).height()+e(window).scrollTop()?r.css({left:n.offset().left,top:n.offset().top-r.outerHeight()}):r.css({left:n.offset().left,top:n.offset().top+n.outerHeight()});r.show();var i=n.data("timepicker-settings"),u=r.find(".ui-timepicker-selected");u.length||(n.val()?u=l(n,r,g(n.val())):i.scrollDefaultNow?u=l(n,r,g(new Date)):i.scrollDefaultTime!==!1&&(u=l(n,r,g(i.scrollDefaultTime))));if(u&&u.length){var f=r.scrollTop()+u.position().top-u.outerHeight();r.scrollTop(f)}else r.scrollTop(0);a();n.trigger("showTimepicker")},hide:function(t){e(".ui-timepicker-list:visible").each(function(){var t=e(this),n=t.data("timepicker-input"),r=n.data("timepicker-settings");r&&r.selectOnBlur&&d(n);t.hide();n.trigger("hideTimepicker")})},option:function(t,n){var r=e(this),i=r.data("timepicker-settings"),s=r.data("timepicker-list");if(typeof t=="object")i=e.extend(i,t);else if(typeof t=="string"&&typeof n!="undefined")i[t]=n;else if(typeof t=="string")return i[t];i.minTime&&(i.minTime=g(i.minTime));i.maxTime&&(i.maxTime=g(i.maxTime));i.durationTime&&(i.durationTime=g(i.durationTime));r.data("timepicker-settings",i);if(s){s.remove();r.data("timepicker-list",!1)}},getSecondsFromMidnight:function(){return g(e(this).val())},getTime:function(){return new Date(t.valueOf()+g(e(this).val())*1e3)},setTime:function(t){var n=e(this),r=m(g(t),n.data("timepicker-settings").timeFormat);n.val(r)},remove:function(){var t=e(this);if(!t.hasClass("ui-timepicker-input"))return;t.removeAttr("autocomplete","off");t.removeClass("ui-timepicker-input");t.removeData("timepicker-settings");t.off(".timepicker");t.data("timepicker-list")&&t.data("timepicker-list").remove();t.removeData("timepicker-list")}};e.fn.timepicker=function(t){if(s[t])return s[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t)return s.init.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.timepicker")}});(function($){"use strict";var escape=/["\\\x00-\x1f\x7f-\x9f]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},hasOwn=Object.prototype.hasOwnProperty;$.toJSON=typeof JSON=="object"&&JSON.stringify?JSON.stringify:function(e){if(e===null)return"null";var t,n,r,i,s=$.type(e);if(s==="undefined")return undefined;if(s==="number"||s==="boolean")return String(e);if(s==="string")return $.quoteString(e);if(typeof e.toJSON=="function")return $.toJSON(e.toJSON());if(s==="date"){var o=e.getUTCMonth()+1,u=e.getUTCDate(),a=e.getUTCFullYear(),f=e.getUTCHours(),l=e.getUTCMinutes(),c=e.getUTCSeconds(),h=e.getUTCMilliseconds();o<10&&(o="0"+o);u<10&&(u="0"+u);f<10&&(f="0"+f);l<10&&(l="0"+l);c<10&&(c="0"+c);h<100&&(h="0"+h);h<10&&(h="0"+h);return'"'+a+"-"+o+"-"+u+"T"+f+":"+l+":"+c+"."+h+'Z"'}t=[];if($.isArray(e)){for(n=0;n<e.length;n++)t.push($.toJSON(e[n])||"null");return"["+t.join(",")+"]"}if(typeof e=="object"){for(n in e)if(hasOwn.call(e,n)){s=typeof n;if(s==="number")r='"'+n+'"';else{if(s!=="string")continue;r=$.quoteString(n)}s=typeof e[n];if(s!=="function"&&s!=="undefined"){i=$.toJSON(e[n]);t.push(r+":"+i)}}return"{"+t.join(",")+"}"}};$.evalJSON=typeof JSON=="object"&&JSON.parse?JSON.parse:function(str){return eval("("+str+")")};$.secureEvalJSON=typeof JSON=="object"&&JSON.parse?JSON.parse:function(str){var filtered=str.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(filtered))return eval("("+str+")");throw new SyntaxError("Error parsing JSON, source is not valid.")};$.quoteString=function(e){return e.match(escape)?'"'+e.replace(escape,function(e){var t=meta[e];if(typeof t=="string")return t;t=e.charCodeAt();return"\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16)})+'"':'"'+e+'"'}})(jQuery);(function(){function m(){var e=!1;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval");e=!0;window.localStorage.removeItem("_tmptest")}catch(t){}if(e)try{if(window.localStorage){i=window.localStorage;u="localStorage";l=i.jStorage_update}}catch(n){}else if("globalStorage"in window)try{if(window.globalStorage){i=window.globalStorage[window.location.hostname];u="globalStorage";l=i.jStorage_update}}catch(r){}else{s=document.createElement("link");if(!s.addBehavior){s=null;return}s.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(s);try{s.load("jStorage")}catch(o){s.setAttribute("jStorage","{}");s.save("jStorage");s.load("jStorage")}var a="{}";try{a=s.getAttribute("jStorage")}catch(f){}try{l=s.getAttribute("jStorage_update")}catch(c){}i.jStorage=a;u="userDataBehavior"}T();k();g("local");g("session");b();L();"addEventListener"in window&&window.addEventListener("pageshow",function(e){e.persisted&&w()},!1)}function g(e,i){function h(){if(e!="session")return;try{l=n.parse(window.name||"{}")}catch(t){l={}}}function p(){if(e!="session")return;window.name=n.stringify(l)}var s=!1,o=0,a,f,l={},c=Math.random();if(!i&&typeof window[e+"Storage"]!="undefined")return;if(e=="local"&&window.globalStorage){localStorage=window.globalStorage[window.location.hostname];return}if(u!="userDataBehavior")return;i&&window[e+"Storage"]&&window[e+"Storage"].parentNode&&window[e+"Storage"].parentNode.removeChild(window[e+"Storage"]);f=document.createElement("button");document.getElementsByTagName("head")[0].appendChild(f);e=="local"?l=r:e=="session"&&h();for(a in l)if(l.hasOwnProperty(a)&&a!="__jstorage_meta"&&a!="length"&&typeof l[a]!="undefined"){a in f||o++;f[a]=l[a]}f.length=o;f.key=function(e){var t=0,n;h();for(n in l)if(l.hasOwnProperty(n)&&n!="__jstorage_meta"&&n!="length"&&typeof l[n]!="undefined"){if(t==e)return n;t++}};f.getItem=function(n){h();return e=="session"?l[n]:t.jStorage.get(n)};f.setItem=function(e,t){if(typeof t=="undefined")return;f[e]=(t||"").toString()};f.removeItem=function(n){if(e=="local")return t.jStorage.deleteKey(n);f[n]=undefined;s=!0;n in f&&f.removeAttribute(n);s=!1};f.clear=function(){if(e=="session"){window.name="";g("session",!0);return}t.jStorage.flush()};e=="local"&&(v=function(e,t){if(e=="length")return;s=!0;if(typeof t=="undefined"){if(e in f){o--;f.removeAttribute(e)}}else{e in f||o++;f[e]=(t||"").toString()}f.length=o;s=!1});f.attachEvent("onpropertychange",function(n){if(n.propertyName=="length")return;if(s||n.propertyName=="length")return;if(e=="local")!(n.propertyName in l)&&typeof f[n.propertyName]!="undefined"&&o++;else if(e=="session"){h();if(typeof f[n.propertyName]=="undefined"||n.propertyName in l)if(typeof f[n.propertyName]=="undefined"&&n.propertyName in l){delete l[n.propertyName];o--}else l[n.propertyName]=f[n.propertyName];else{l[n.propertyName]=f[n.propertyName];o++}p();f.length=o;return}t.jStorage.set(n.propertyName,f[n.propertyName]);f.length=o});window[e+"Storage"]=f}function y(){var e="{}";if(u=="userDataBehavior"){s.load("jStorage");try{e=s.getAttribute("jStorage")}catch(t){}try{l=s.getAttribute("jStorage_update")}catch(n){}i.jStorage=e}T();k();L()}function b(){u=="localStorage"||u=="globalStorage"?"addEventListener"in window?window.addEventListener("storage",w,!1):document.attachEvent("onstorage",w):u=="userDataBehavior"&&setInterval(w,1e3)}function w(){var e;clearTimeout(f);f=setTimeout(function(){if(u=="localStorage"||u=="globalStorage")e=i.jStorage_update;else if(u=="userDataBehavior"){s.load("jStorage");try{e=s.getAttribute("jStorage_update")}catch(t){}}if(e&&e!=l){l=e;E()}},25)}function E(){var e=n.parse(n.stringify(r.__jstorage_meta.CRC32)),t;y();t=n.parse(n.stringify(r.__jstorage_meta.CRC32));var i,s=[],o=[];for(i in e)if(e.hasOwnProperty(i)){if(!t[i]){o.push(i);continue}e[i]!=t[i]&&String(e[i]).substr(0,2)=="2."&&s.push(i)}for(i in t)t.hasOwnProperty(i)&&(e[i]||s.push(i));S(s,"updated");S(o,"deleted")}function S(e,t){e=[].concat(e||[]);if(t=="flushed"){e=[];for(var n in a)a.hasOwnProperty(n)&&e.push(n);t="deleted"}for(var r=0,i=e.length;r<i;r++)if(a[e[r]])for(var s=0,o=a[e[r]].length;s<o;s++)a[e[r]][s](e[r],t)}function x(){var e=(+(new Date)).toString();if(u=="localStorage"||u=="globalStorage")i.jStorage_update=e;else if(u=="userDataBehavior"){s.setAttribute("jStorage_update",e);s.save("jStorage")}w()}function T(){if(i.jStorage)try{r=n.parse(String(i.jStorage))}catch(e){i.jStorage="{}"}else i.jStorage="{}";o=i.jStorage?String(i.jStorage).length:0;r.__jstorage_meta||(r.__jstorage_meta={});r.__jstorage_meta.CRC32||(r.__jstorage_meta.CRC32={})}function N(){O();try{i.jStorage=n.stringify(r);if(s){s.setAttribute("jStorage",i.jStorage);s.save("jStorage")}o=i.jStorage?String(i.jStorage).length:0}catch(e){}}function C(e){if(!e||typeof e!="string"&&typeof e!="number")throw new TypeError("Key name must be string or numeric");if(e=="__jstorage_meta")throw new TypeError("Reserved key name");return!0}function k(){var e,t,n,i,s=Infinity,o=!1,u=[];clearTimeout(p);if(!r.__jstorage_meta||typeof r.__jstorage_meta.TTL!="object")return;e=+(new Date);n=r.__jstorage_meta.TTL;i=r.__jstorage_meta.CRC32;for(t in n)if(n.hasOwnProperty(t))if(n[t]<=e){delete n[t];delete i[t];delete r[t];o=!0;u.push(t)}else n[t]<s&&(s=n[t]);s!=Infinity&&(p=setTimeout(k,s-e));if(o){N();x();S(u,"deleted")}}function L(){if(!r.__jstorage_meta.PubSub)return;var e,t=h;for(var n=len=r.__jstorage_meta.PubSub.length-1;n>=0;n--){e=r.__jstorage_meta.PubSub[n];if(e[0]>h){t=e[0];A(e[1],e[2])}}h=t}function A(e,t){if(c[e])for(var r=0,i=c[e].length;r<i;r++)c[e][r](e,n.parse(n.stringify(t)))}function O(){if(!r.__jstorage_meta.PubSub)return;var e=+(new Date)-2e3;for(var t=0,n=r.__jstorage_meta.PubSub.length;t<n;t++)if(r.__jstorage_meta.PubSub[t][0]<=e){r.__jstorage_meta.PubSub.splice(t,r.__jstorage_meta.PubSub.length-t);break}r.__jstorage_meta.PubSub.length||delete r.__jstorage_meta.PubSub}function M(e,t){r.__jstorage_meta||(r.__jstorage_meta={});r.__jstorage_meta.PubSub||(r.__jstorage_meta.PubSub=[]);r.__jstorage_meta.PubSub.unshift([+(new Date),e,t]);N();x()}function _(e,t){var n=e.length,r=t^n,i=0,s;while(n>=4){s=e.charCodeAt(i)&255|(e.charCodeAt(++i)&255)<<8|(e.charCodeAt(++i)&255)<<16|(e.charCodeAt(++i)&255)<<24;s=(s&65535)*1540483477+(((s>>>16)*1540483477&65535)<<16);s^=s>>>24;s=(s&65535)*1540483477+(((s>>>16)*1540483477&65535)<<16);r=(r&65535)*1540483477+(((r>>>16)*1540483477&65535)<<16)^s;n-=4;++i}switch(n){case 3:r^=(e.charCodeAt(i+2)&255)<<16;case 2:r^=(e.charCodeAt(i+1)&255)<<8;case 1:r^=e.charCodeAt(i)&255;r=(r&65535)*1540483477+(((r>>>16)*1540483477&65535)<<16)}r^=r>>>13;r=(r&65535)*1540483477+(((r>>>16)*1540483477&65535)<<16);r^=r>>>15;return r>>>0}var e="0.3.2",t=window.jQuery||window.$||(window.$={}),n={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(e){return String(e).evalJSON()}||t.parseJSON||t.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||t.toJSON};if(!n.parse||!n.stringify)throw new Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page");var r={__jstorage_meta:{CRC32:{}}},i={jStorage:"{}"},s=null,o=0,u=!1,a={},f=!1,l=0,c={},h=+(new Date),p,d={isXML:function(e){var t=(e?e.ownerDocument||e:0).documentElement;return t?t.nodeName!=="HTML":!1},encode:function(e){if(!this.isXML(e))return!1;try{return(new XMLSerializer).serializeToString(e)}catch(t){try{return e.xml}catch(n){}}return!1},decode:function(e){var t="DOMParser"in window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(e){var t=new ActiveXObject("Microsoft.XMLDOM");t.async="false";t.loadXML(e);return t},n;if(!t)return!1;n=t.call("DOMParser"in window&&new DOMParser||window,e,"text/xml");return this.isXML(n)?n:!1}},v=function(){};t.jStorage={version:e,set:function(e,t,i){C(e);i=i||{};if(typeof t=="undefined"){this.deleteKey(e);return t}if(d.isXML(t))t={_is_xml:!0,xml:d.encode(t)};else{if(typeof t=="function")return undefined;t&&typeof t=="object"&&(t=n.parse(n.stringify(t)))}r[e]=t;r.__jstorage_meta.CRC32[e]="2."+_(n.stringify(t));this.setTTL(e,i.TTL||0);v(e,t);S(e,"updated");return t},get:function(e,t){C(e);return e in r?r[e]&&typeof r[e]=="object"&&r[e]._is_xml?d.decode(r[e].xml):r[e]:typeof t=="undefined"?null:t},deleteKey:function(e){C(e);if(e in r){delete r[e];typeof r.__jstorage_meta.TTL=="object"&&e in r.__jstorage_meta.TTL&&delete r.__jstorage_meta.TTL[e];delete r.__jstorage_meta.CRC32[e];v(e,undefined);N();x();S(e,"deleted");return!0}return!1},setTTL:function(e,t){var n=+(new Date);C(e);t=Number(t)||0;if(e in r){r.__jstorage_meta.TTL||(r.__jstorage_meta.TTL={});t>0?r.__jstorage_meta.TTL[e]=n+t:delete r.__jstorage_meta.TTL[e];N();k();x();return!0}return!1},getTTL:function(e){var t=+(new Date),n;C(e);if(e in r&&r.__jstorage_meta.TTL&&r.__jstorage_meta.TTL[e]){n=r.__jstorage_meta.TTL[e]-t;return n||0}return 0},flush:function(){r={__jstorage_meta:{CRC32:{}}};g("local",!0);N();x();S(null,"flushed");return!0},storageObj:function(){function e(){}e.prototype=r;return new e},index:function(){var e=[],t;for(t in r)r.hasOwnProperty(t)&&t!="__jstorage_meta"&&e.push(t);return e},storageSize:function(){return o},currentBackend:function(){return u},storageAvailable:function(){return!!u},listenKeyChange:function(e,t){C(e);a[e]||(a[e]=[]);a[e].push(t)},stopListening:function(e,t){C(e);if(!a[e])return;if(!t){delete a[e];return}for(var n=a[e].length-1;n>=0;n--)a[e][n]==t&&a[e].splice(n,1)},subscribe:function(e,t){e=(e||"").toString();if(!e)throw new TypeError("Channel not defined");c[e]||(c[e]=[]);c[e].push(t)},publish:function(e,t){e=(e||"").toString();if(!e)throw new TypeError("Channel not defined");M(e,t)},reInit:function(){y()}};m()})();InfoBox.prototype=new google.maps.OverlayView;InfoBox.prototype.createInfoBoxDiv_=function(){var e,t=this,n=function(e){e.cancelBubble=!0;e.stopPropagation&&e.stopPropagation()},r=function(e){e.returnValue=!1;e.preventDefault&&e.preventDefault();t.enableEventPropagation_||n(e)};if(!this.div_){this.div_=document.createElement("div");this.setBoxStyle_();if(typeof this.content_.nodeType=="undefined")this.div_.innerHTML=this.getCloseBoxImg_()+this.content_;else{this.div_.innerHTML=this.getCloseBoxImg_();this.div_.appendChild(this.content_)}this.getPanes()[this.pane_].appendChild(this.div_);this.addClickHandler_();if(this.div_.style.width)this.fixedWidthSet_=!0;else if(this.maxWidth_!==0&&this.div_.offsetWidth>this.maxWidth_){this.div_.style.width=this.maxWidth_;this.div_.style.overflow="auto";this.fixedWidthSet_=!0}else{e=this.getBoxWidths_();this.div_.style.width=this.div_.offsetWidth-e.left-e.right+"px";this.fixedWidthSet_=!1}this.panBox_(this.disableAutoPan_);if(!this.enableEventPropagation_){this.eventListener1_=google.maps.event.addDomListener(this.div_,"mousedown",n);this.eventListener2_=google.maps.event.addDomListener(this.div_,"click",n);this.eventListener3_=google.maps.event.addDomListener(this.div_,"dblclick",n)}this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",r);google.maps.event.trigger(this,"domready")}};InfoBox.prototype.getCloseBoxImg_=function(){var e="";if(this.closeBoxURL_!==""){e="<img";e+=" src='"+this.closeBoxURL_+"'";e+=" align=right";e+=" style='";e+=" position: relative;";e+=" cursor: pointer;";e+=" margin: "+this.closeBoxMargin_+";";e+="'>"}return e};InfoBox.prototype.addClickHandler_=function(){var e;if(this.closeBoxURL_!==""){e=this.div_.firstChild;this.closeListener_=google.maps.event.addDomListener(e,"click",this.getCloseClickHandler_())}else this.closeListener_=null};InfoBox.prototype.getCloseClickHandler_=function(){var e=this;return function(t){t.cancelBubble=!0;t.stopPropagation&&t.stopPropagation();e.close();google.maps.event.trigger(e,"closeclick")}};InfoBox.prototype.panBox_=function(e){var t,n,r=0,i=0;if(!e){t=this.getMap();if(t instanceof google.maps.Map){t.getBounds().contains(this.position_)||t.setCenter(this.position_);n=t.getBounds();var s=t.getDiv(),o=s.offsetWidth,u=s.offsetHeight,a=this.pixelOffset_.width,f=this.pixelOffset_.height,l=this.div_.offsetWidth,c=this.div_.offsetHeight,h=this.infoBoxClearance_.width,p=this.infoBoxClearance_.height,d=this.getProjection().fromLatLngToContainerPixel(this.position_);d.x<-a+h?r=d.x+a-h:d.x+l+a+h>o&&(r=d.x+l+a+h-o);this.alignBottom_?d.y<-f+p+c?i=d.y+f-p-c:d.y+f+p>u&&(i=d.y+f+p-u):d.y<-f+p?i=d.y+f-p:d.y+c+f+p>u&&(i=d.y+c+f+p-u);if(r!==0||i!==0){var v=t.getCenter();t.panBy(r,i)}}}};InfoBox.prototype.setBoxStyle_=function(){var e,t;if(this.div_){this.div_.className=this.boxClass_;this.div_.style.cssText="";t=this.boxStyle_;for(e in t)t.hasOwnProperty(e)&&(this.div_.style[e]=t[e]);typeof this.div_.style.opacity!="undefined"&&this.div_.style.opacity!==""&&(this.div_.style.filter="alpha(opacity="+this.div_.style.opacity*100+")");this.div_.style.position="absolute";this.div_.style.visibility="hidden";this.zIndex_!==null&&(this.div_.style.zIndex=this.zIndex_)}};InfoBox.prototype.getBoxWidths_=function(){var e,t={top:0,bottom:0,left:0,right:0},n=this.div_;if(document.defaultView&&document.defaultView.getComputedStyle){e=n.ownerDocument.defaultView.getComputedStyle(n,"");if(e){t.top=parseInt(e.borderTopWidth,10)||0;t.bottom=parseInt(e.borderBottomWidth,10)||0;t.left=parseInt(e.borderLeftWidth,10)||0;t.right=parseInt(e.borderRightWidth,10)||0}}else if(document.documentElement.currentStyle&&n.currentStyle){t.top=parseInt(n.currentStyle.borderTopWidth,10)||0;t.bottom=parseInt(n.currentStyle.borderBottomWidth,10)||0;t.left=parseInt(n.currentStyle.borderLeftWidth,10)||0;t.right=parseInt(n.currentStyle.borderRightWidth,10)||0}return t};InfoBox.prototype.onRemove=function(){if(this.div_){this.div_.parentNode.removeChild(this.div_);this.div_=null}};InfoBox.prototype.draw=function(){this.createInfoBoxDiv_();var e=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=e.x+this.pixelOffset_.width+"px";this.alignBottom_?this.div_.style.bottom=-(e.y+this.pixelOffset_.height)+"px":this.div_.style.top=e.y+this.pixelOffset_.height+"px";this.isHidden_?this.div_.style.visibility="hidden":this.div_.style.visibility="visible"};InfoBox.prototype.setOptions=function(e){if(typeof e.boxClass!="undefined"){this.boxClass_=e.boxClass;this.setBoxStyle_()}if(typeof e.boxStyle!="undefined"){this.boxStyle_=e.boxStyle;this.setBoxStyle_()}typeof e.content!="undefined"&&this.setContent(e.content);typeof e.disableAutoPan!="undefined"&&(this.disableAutoPan_=e.disableAutoPan);typeof e.maxWidth!="undefined"&&(this.maxWidth_=e.maxWidth);typeof e.pixelOffset!="undefined"&&(this.pixelOffset_=e.pixelOffset);typeof e.position!="undefined"&&this.setPosition(e.position);typeof e.zIndex!="undefined"&&this.setZIndex(e.zIndex);typeof e.closeBoxMargin!="undefined"&&(this.closeBoxMargin_=e.closeBoxMargin);typeof e.closeBoxURL!="undefined"&&(this.closeBoxURL_=e.closeBoxURL);typeof e.infoBoxClearance!="undefined"&&(this.infoBoxClearance_=e.infoBoxClearance);typeof e.isHidden!="undefined"&&(this.isHidden_=e.isHidden);typeof e.enableEventPropagation!="undefined"&&(this.enableEventPropagation_=e.enableEventPropagation);this.div_&&this.draw()};InfoBox.prototype.setContent=function(e){this.content_=e;if(this.div_){if(this.closeListener_){google.maps.event.removeListener(this.closeListener_);this.closeListener_=null}this.fixedWidthSet_||(this.div_.style.width="");if(typeof e.nodeType=="undefined")this.div_.innerHTML=this.getCloseBoxImg_()+e;else{this.div_.innerHTML=this.getCloseBoxImg_();this.div_.appendChild(e)}if(!this.fixedWidthSet_){this.div_.style.width=this.div_.offsetWidth+"px";this.div_.innerHTML=this.getCloseBoxImg_()+e}this.addClickHandler_()}google.maps.event.trigger(this,"content_changed")};InfoBox.prototype.setPosition=function(e){this.position_=e;this.div_&&this.draw();google.maps.event.trigger(this,"position_changed")};InfoBox.prototype.setZIndex=function(e){this.zIndex_=e;this.div_&&(this.div_.style.zIndex=e);google.maps.event.trigger(this,"zindex_changed")};InfoBox.prototype.getContent=function(){return this.content_};InfoBox.prototype.getPosition=function(){return this.position_};InfoBox.prototype.getZIndex=function(){return this.zIndex_};InfoBox.prototype.show=function(){this.isHidden_=!1;this.div_&&(this.div_.style.visibility="visible")};InfoBox.prototype.hide=function(){this.isHidden_=!0;this.div_&&(this.div_.style.visibility="hidden")};InfoBox.prototype.open=function(e,t){var n=this;if(t){this.position_=t.getPosition();this.moveListener_=google.maps.event.addListener(t,"position_changed",function(){n.setPosition(this.getPosition())})}this.setMap(e);this.visible=!0;this.div_&&this.panBox_()};InfoBox.prototype.close=function(){if(this.closeListener_){google.maps.event.removeListener(this.closeListener_);this.closeListener_=null}if(this.eventListener1_){google.maps.event.removeListener(this.eventListener1_);google.maps.event.removeListener(this.eventListener2_);google.maps.event.removeListener(this.eventListener3_);this.eventListener1_=null;this.eventListener2_=null;this.eventListener3_=null}if(this.moveListener_){google.maps.event.removeListener(this.moveListener_);this.moveListener_=null}if(this.contextListener_){google.maps.event.removeListener(this.contextListener_);this.contextListener_=null}this.setMap(null);this.visible=!1};(function(){var e=navigator.geolocation,t={city:"Chicago",lat:41.85,lng:-87.675,state:"IL",styles:"grey minlabels",zoom:14},n=[],r={lat:null,lng:null,LatLng:null,address:null},i={data:[]},s=new Date,o={month:s.getMonth()+1,date:s.getDate(),year:s.getFullYear()},u="No Schedule Available",a={data:[],LatLngs:[],Markers:[],InfoBox:[],InfoBoxText:[],toggleInfoBox:function(e,t,n){return function(){n.visible?n.close(e,t):n.open(e,t)}}};$("#grp-mylocation,#grp-travel,#grp-time").hide();$(function(){function m(){if($("#school").val()!="")for(var e in a.data)if(a.data[e].shortname==$("#school").val()){f.Map.setCenter(a.LatLngs[e]);a.InfoBox[e].open(f.Map,a.Markers[e])}else a.InfoBox[e].close(f.Map,a.Markers[e])}function g(){console.log("centeronmylocation")}function y(e){e?alert("We're sorry. Your browser's geolocation service failed."):alert("We're sorry! Your browser does not support geolocation.")}function b(){function t(){alert("We're sorry. We could not find an address for this location.")}e?navigator.geolocation.getCurrentPosition(function(e){r.lat=e.coords.latitude;r.lng=e.coords.longitude;r.LatLng=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);var n=new google.maps.Geocoder;n.geocode({latLng:r.LatLng},function(e,n){if(n==google.maps.GeocoderStatus.OK)if(e[1]){var i=e[0].formatted_address.split(",");r.address=i[0];$("#mylocation").val(i[0]);$.jStorage.storageAvailable()&&$.jStorage.set("mylocation",i[0])}else t();else t()})},function(){y(!0)}):y(!1)}function w(e){e.style.padding="1em";var t=document.createElement("div");t.style.backgroundColor="white";t.style.borderStyle="solid";t.style.borderWidth="2px";t.style.cursor="pointer";t.style.textAlign="center";t.title="Click to interact with the map.";e.appendChild(t);var n=document.createElement("div");n.style.fontFamily="sans-serif";n.style.fontSize="12px";n.style.paddingLeft=".5em";n.style.paddingRight=".5em";n.style.paddingTop=".3em";n.style.paddingBottom=".3em";n.innerHTML="Explore Map";t.appendChild
(n);google.maps.event.addDomListener(t,"click",function(){if(f.Map.zoomControl==0){f.setPanZoom(!0);f.setTouchScroll(!1);var e=f.Map.getCenter();$("#before-map,#div-footer").hide(750,function(){$("#map-width").css("height","100%");$("#map-ratio").css("margin-top",window.innerHeight);$("#div-map").offset().top;t.title="Click to close up the map.";n.innerHTML="Minimize";f.Map.setCenter(e);google.maps.event.trigger(f.Map,"resize")});for(var r in a.Markers)google.maps.event.addListener(a.Markers[r],"click",a.toggleInfoBox(f.Map,a.Markers[r],a.InfoBox[r]))}else{f.setPanZoom(!1);f.setTouchScroll(!0);var e=f.Map.getCenter();$("#before-map,#div-footer").show(750,function(){$("#map-width").css("height","");$("#map-ratio").css("margin-top","200px");t.title="Click to interact with the map.";n.innerHTML="Explore Map";f.Map.setCenter(e);google.maps.event.trigger(f.Map,"resize")});for(var r in a.Markers)google.maps.event.clearListeners(a.Markers[r],"click")}})}if($.jStorage.storageAvailable()){$("#school").val($.jStorage.get("school",""));$("#mylocation").val($.jStorage.get("mylocation",""));var s=$.jStorage.get("travel","");s==="WALKING"?$("#travel-walking").addClass("active"):s==="TRANSIT"?$("#travel-transit").addClass("active"):s==="DRIVING"&&$("#travel-driving").addClass("active")}$("#loading").hide();$(document).ajaxStart(function(){$("#loading").show()}).ajaxStop(function(){$("#loading").hide()});var f=new TkMap({domid:"map",lat:t.lat,lng:t.lng,styles:t.styles,zoom:t.zoom});f.initMap();f.setPanZoom(!1);f.setTouchScroll(!0);var l=document.createElement("div"),c=new w(l);l.index=1;f.Map.controls[google.maps.ControlPosition.TOP_RIGHT].push(l);var h=encodeURIComponent("SELECT date, dayofweek, unifiedcalendar FROM 1u765vIMSPecSEinBe1H6JPYSFE5ljbAW1Mq3okc"),p=["https://www.googleapis.com/fusiontables/v1/query"];p.push("?sql="+h);p.push("&key=AIzaSyDH5WuL3gKYVBWVqLr6g3PQffdZE-XhBUw");p.push("&callback=?");$.ajax({url:p.join(""),dataType:"jsonp",success:function(e){var t=o.month+"/"+o.date+"/"+o.year;for(var n in e.rows){i.data[n]=[];for(var r in e.columns){var s=e.columns[r];i.data[n][s]=e.rows[n][r]}i.data[n].date==t&&(u=i.data[n].unifiedcalendar)}if(u==="Full Day"){$("#schedule").html("Yes - "+u);$("#schedule").addClass("text-success")}else if(u==="No Schedule Available"){$("#schedule").html("We don't know - "+u);$("#schedule").addClass("text-warning")}else{$("#schedule").html("No - "+u);$("#schedule").addClass("text-error")}}});var d=encodeURIComponent("SELECT lat, lng, shortname, address, postalcode, phone, start, end, afterstart, afterend FROM 1QQu0GHzbkKk5OdAl2VaaY2sm1Ggoc8Vo5GfiGLI"),v=["https://www.googleapis.com/fusiontables/v1/query"];v.push("?sql="+d);v.push("&key=AIzaSyDH5WuL3gKYVBWVqLr6g3PQffdZE-XhBUw");v.push("&callback=?");$.ajax({url:v.join(""),dataType:"jsonp",success:function(e){for(var t in e.rows){a.data[t]=[];for(var r in e.columns){var i=e.columns[r];a.data[t][i]=e.rows[t][r]}n.push(e.rows[t][2]);a.LatLngs[t]=new google.maps.LatLng(e.rows[t][0],e.rows[t][1]);a.Markers[t]=new google.maps.Marker({position:a.LatLngs[t],map:f.Map,icon:"img/orange.png",shadow:"img/msmarker.shadow.png"});a.InfoBoxText[t]='<div class="infoBox" style="border:2px solid rgb(0,0,0); margin-top:8px; background:rgb(25,25,112); padding:5px; color:white; font-size:80%;">'+e.rows[t][2]+"<br />"+e.rows[t][3]+"<br />"+e.rows[t][5]+"<br /></div>";var s={content:a.InfoBoxText[t],disableAutoPan:!1,maxWidth:0,pixelOffset:new google.maps.Size(-140,0),zIndex:null,boxStyle:{background:"url('img/tipbox.gif') no-repeat",opacity:.9,width:"160px"},closeBoxMargin:"11px 4px 4px 4px",closeBoxURL:"img/close.gif",infoBoxClearance:new google.maps.Size(1,1),visible:!1,pane:"floatPane",enableEventPropagation:!1};a.InfoBox[t]=new InfoBox(s)}m();$("#school").typeahead({source:n,items:3,minLength:1})}});$("#school").change(function(){$.jStorage.storageAvailable()&&$.jStorage.set("school",$("#school").val());m()});$("#school-next").click(function(){$("#grp-school").hide();$("#grp-mylocation").show()});$("#school").blur(function(){m()});$("#mylocation-gps").click(function(){b()});$("#mylocation").change(function(){function e(){alert("We're sorry. We could not locate this address. Please doublecheck you've entered your address correctly.")}$.jStorage.storageAvailable()&&$.jStorage.set("mylocation",$("#mylocation").val());if($("#mylocation").val()!=r.address){var n=new google.maps.Geocoder;n.geocode({address:$("#mylocation").val()+", "+t.city+", "+t.state},function(t,n){if(n==google.maps.GeocoderStatus.OK)if(t[0]){r.LatLng=t[0].geometry.location;r.lat=r.LatLng.lat();r.lng=r.LatLng.lng();r.address=$("#mylocation").val()}else e();else e()})}});$("#mylocation-next").click(function(){$("#grp-mylocation").hide();$("#grp-travel").show()});$("#time-next").click(function(){$("#grp-time").hide()});$(".travel").on("click",function(){$.jStorage.storageAvailable()&&$.jStorage.set("travel",$(this).val())})})})();